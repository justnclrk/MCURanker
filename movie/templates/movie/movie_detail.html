{% extends "mcurank/base.html" %}
{% block title %} | {{ movie.title }}{% endblock %}
{% load crispy_forms_tags %}
{% block content %}
<section class="section section__tertiary">
    <h3 class="title__detail__header">{{ movie.title }}</h3>
    <h4 class="title__detail__rank__text">Average Rank:
        <span class="title__detail__rank__number">
            {% if average_rank.number__avg is None %}n/a{% else %}
            {{ average_rank.number__avg|floatformat }}{% endif %}
        </span>
    </h4>
    <div class="title__detail">
        <figure class="title__detail__img__container">
            <img class="title__detail__img" src="{{ movie.image.url }}" alt="{{ movie.title }}">
        </figure>
        <ul class="title__detail__list">
            <li class="title__detail__list--item">{{ movie.overview }}</li>
            <li class="title__detail__list--item">Release Year: {{ movie.release_date }}</li>
            <li class="title__detail__list--item">Phase: {{ movie.phase }}</li>
            {% if movie.active is True %}
            {% if ranked_movie is None %}
            <li class="title__detail__list--item"><a href="{% url 'rank-create' movie.slug %}">Rank This
                    Movie!</a>
            </li>
            {% else %}
            <li class="title__detail__list--item"><a href="{% url 'rank-update' ranked_movie.slug %}">Update Rank</a>
            </li>
            {% endif %}
            {% endif %}
        </ul>
    </div>

    <h3>Rank and Reviews</h3>
    <ul>
        {% for rank in movie_ranks %}
        <li>
            <div>
                <ul>
                    <li> <a href="{% url 'user-detail' rank.user.username %}">{{ rank.user.username }}
                        </a>(<span>{% if rank.number == None%}No
                            Rank{% else %}{{ rank.number }}{% endif %}</span>)</li>
                    <li>{{ rank.review }}</li>
                    <li><small><span>Last Updated:
                            </span>{{ rank.updated_at|date:"SHORT_DATE_FORMAT" }}</small>
                    </li>
                </ul>
            </div>
        </li>
        {% endfor %}
    </ul>
</section>
{% endblock content %}